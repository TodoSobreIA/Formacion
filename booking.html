<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Cita</title>
</head>
<body>
    <h2>Reserva tu Cita</h2>
    <form id="bookingForm">
        <label for="date">Elige una fecha:</label>
        <input type="date" id="date" name="date" required>

        <label for="time">Elige una hora:</label>
        <select id="time" name="time" required></select>

        <button type="submit">Reservar</button>
    </form>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let dateInput = document.getElementById("date");
            let timeSelect = document.getElementById("time");

            function setMinDate() {
                let today = new Date();
                let minDate = today.toISOString().split("T")[0];
                dateInput.min = minDate;
            }

            function generateTimeOptions() {
                timeSelect.innerHTML = ""; // Limpiar opciones previas
                for (let hour = 0; hour < 24; hour++) {
                    ["00", "30"].forEach(min => {
                        let timeOption = document.createElement("option");
                        let timeString = `${String(hour).padStart(2, "0")}:${min}`;
                        timeOption.value = timeString;
                        timeOption.textContent = timeString;
                        timeSelect.appendChild(timeOption);
                    });
                }
            }

            setMinDate();
            generateTimeOptions();

            document.getElementById("bookingForm").addEventListener("submit", function (event) {
                event.preventDefault();

                let selectedDate = dateInput.value;
                let selectedTime = timeSelect.value;
                let selectedDateTime = `${selectedDate}T${selectedTime}`;

                fetch("https://script.google.com/macros/s/AKfycbwOxjkJtZC4vXEj3WsfKP-La2Oy9rsCjPzcR5Oblg8dhRY8XwbFG-9jCsA3uzofJsxn4g/exec", {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ datetime: selectedDateTime })
                })
                .then(() => alert("Reserva enviada con Ã©xito"))
                .catch(() => alert("Error al reservar"));
            });
        });
    </script>
</body>
</html>
